# Web Hooks

A customer can provide a single URL to be called with a notifications when
various events occur related to his/her orders. Also customers may opt-in/out
to various order events that trigger notifications. Order events which a
customer may choose to receive notifications for are: `received`, `printed`, 
`shipped`, and `cancelled`.

This is a beta feature of the API, so consider Web hook notifications
as experimental behavior.

## Create a Web Hook

This endpoint will submit a new Web hook record.

- Customers should only have one Web Hook.
- The URL for a customer's webhook must be unique.

<%= partial "includes/api/curl_snippets/post_webhook_request.md" %>

> The above command returns JSON structured like this:

<%= partial "includes/api/json_snippets/post_webhook_response.md" %>

> User and URL must be unique, otherwise an 422 will be returned

<%= partial "includes/api/json_snippets/post_webhook_error.md" %>

### HTTPS Request

`POST https://api.mwwondemand.com/api/webhooks`


### POST Parameters

Attributes ||
--------- | ------- | -----------
data <br><em>object</em> | The root element of your JSON post object.
type <br><em>string</em> | Resource the object represents. This will always be "webhooks".
attributes | object | The object that contains all the pertanent information about the order.
url <br><em>string</em> | The URL to receive callback notifications.
enabled <br><em>boolean</em> | Pause notifications by setting false.
received <br><em>boolean</em> | Fired when an order is received.
printed <br><em>boolean</em> | Fired after all items in an order are printed.
shipped <br><em>boolean</em> | Fired when all items in an order are shipped.
cancelled <br><em>boolean</em> | Fired when an entire order is cancelled.

*Note: This endpoint follows the [JSON API 1.0 Spec](http://jsonapi.org/format/1.0/)*

In the future there may be support for line item event notifications such as:
`pressed`, `cut`, `sewn`, `turned`, `packed`, or `shipped`.

### Errors

- 422 Unprocessable Entity

Code | Attribute | Description
---- | --------- | -----------
422 | user-id | Customer can only have one Web hook
422 | url | URL must be unique in the MWWOndemand system


## Show Web Hook Details

Shows Web hook attributes.

`GET https://api.mwwondemand.com/api/webhooks`

Or,

`GET https://api.mwwondemand.com/api/webhooks/:id`

<%= partial "includes/api/curl_snippets/get_webhooks_request.md" %>

> The above command returns JSON structured like this:

<%= partial "includes/api/json_snippets/get_webhooks_response.md" %>


## Patch Web hook Attributes

Update attributes, e.g. opt-in to receive notifications for additional events.

`GET https://api.mwwondemand.com/api/webhooks/:id`

<%= partial "includes/api/curl_snippets/patch_webhook_request.md" %>

> The above command returns JSON structured like this:

<%= partial "includes/api/json_snippets/patch_webhook_response.md" %>


## Delete Web Hook

Remove customer Web hook.

`GET https://api.mwwondemand.com/api/webhooks/:id`

<%= partial "includes/api/curl_snippets/delete_webhook_request.md" %>

> The above command returns JSON structured like this:

<%= partial "includes/api/json_snippets/delete_webhook_response.md" %>

## Web Hook Notifications

> Example POST payload (JSON) for the (order) `received` event:

<%= partial "includes/api/json_snippets/post_webhook_notification.md" %>

Based on your opt-in preferences for various events, the API will POST back
to the your Web Hook URL. The web hook url and settings are available in your
profile, see the <https://api.mwwondemand.com/account/> page.

The `url` (string) must be a valid URL (an API endpoint you host) and the
`enabled` (boolean) setting must be checked.

First login, then visit <https://api.mwwondemand.com/account/user/webhooks> to
edit your Web Hooks (opt-in) preferences.

- The `enabled` checkbox must be `checked` in order to receive POST notifications.
- Check the various events that you would like to receive notifications for.

|Events for Orders|
|-----------------|
|Received|
|Printed|
|Shipped|
|Cancelled|

To the right is an example JSON payload for a POST notification sent after an
order is received.
